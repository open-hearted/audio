<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Gaza Audio Sentence Tracker</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: sans-serif;
      padding: 1rem;
      line-height: 1.6;
      max-width: 600px;
      margin: auto;
    }
    h1, h2 {
      font-size: 1.2rem;
    }
    .status {
      margin-top: 0.3rem;
      font-size: 1rem;
    }
    .collapsible {
      background-color: #eee;
      cursor: pointer;
      padding: 10px;
      border: none;
      text-align: left;
      font-size: 1rem;
      margin-top: 0.8rem;
      width: 100%;
      border-radius: 5px;
    }
    .active, .collapsible:hover {
      background-color: #ccc;
    }
    .content {
      padding: 0.8rem;
      display: none;
      overflow: hidden;
      background-color: #f9f9f9;
      border: 1px solid #ccc;
      white-space: pre-wrap;
      border-radius: 5px;
    }
    .block {
      margin-bottom: 2rem;
    }
    audio {
      width: 100%;
    }
  </style>
</head>
<body>

  <script>
    const sentences = [
      "The UK-based Al Khair Foundation said a team of charity workers has been killed in Israeli airstrikes in northern Gaza.",
      "The charity says at least 8 workers, including volunteers and journalists documenting their work, were killed when their vehicles were targeted Saturday.",
      "Hamas called it a blatant violation of the ceasefire agreement with Israel.",
      "The Israeli military said it struck two terrorists operating a drone that posed a threat to Israeli troops and later targeted additional terrorists at the scene.",
      "The charity denies the allegation, saying its team members were not terrorists.",
      "The attack comes as US-designated terror group Hamas leaders hold ceasefire talks with mediators in Cairo.",
      "Hamas says it will only release an American-Israeli hostage and the bodies of four others if Israel fully implements the ceasefire agreement in Gaza.",
      "A senior Hamas official says talks on the truce's next phase must start immediately and last no more than 50 days."
    ];

    function getFormattedDateTime() {
      const now = new Date();
      const yyyy = now.getFullYear();
      const mm = String(now.getMonth() + 1).padStart(2, '0');
      const dd = String(now.getDate()).padStart(2, '0');
      const hh = String(now.getHours()).padStart(2, '0');
      const min = String(now.getMinutes()).padStart(2, '0');
      return `${yyyy}-${mm}-${dd} ${hh}:${min}`;
    }

    function setupBlock(audioId, statusId, storageKey) {
      const audio = document.getElementById(audioId);
      const status = document.getElementById(statusId);
      const stored = localStorage.getItem(storageKey);
      if (stored) {
        const data = JSON.parse(stored);
        status.textContent = `âœ… Played (${data.timestamp})`;
      }

      audio.addEventListener('ended', () => {
        const timestamp = getFormattedDateTime();
        localStorage.setItem(storageKey, JSON.stringify({ played: true, timestamp }));
        status.textContent = `âœ… Played (${timestamp})`;
      });
    }

    // Sentence blocks 1-8
    const container = document.createElement('div');
    for (let i = 0; i < sentences.length; i++) {
      const num = i + 1;
      const audioId = `audio${num}`;
      const statusId = `status${num}`;
      const scriptId = `script${num}`;
      const storageKey = `audioPlayed_v${num}`;
      const block = document.createElement('div');
      block.className = 'block';
      block.innerHTML = `
        <h2>Sentence ${num}/8</h2>
        <audio id="${audioId}" controls>
          <source src="March%2015%202025%20-%201800%20UTC%20Gaza%20%20Israeli%20Airstrike%20Kills%20Aid%20Workers/${num}.mp3" type="audio/mpeg">
        </audio>
        <div class="status" id="${statusId}">â¬œ Not played</div>
        <button class="collapsible">ðŸ“œ Show Script</button>
        <div class="content" id="${scriptId}">${sentences[i]}</div>
      `;
      document.body.appendChild(block);
      setTimeout(() => setupBlock(audioId, statusId, storageKey), 0);
    }
  </script>

  <!-- Full article block (at bottom) -->
  <div class="block">
    <h2>Full News Audio</h2>
    <audio id="audioFull" controls>
      <source src="March%2015%202025%20-%201800%20UTC%20Gaza%20%20Israeli%20Airstrike%20Kills%20Aid%20Workers/March%2015%202025%20-%201800%20UTC%20Gaza%20%20Israeli%20Airstrike%20Kills%20Aid%20Workers.mp3" type="audio/mpeg">
    </audio>
    <div class="status" id="statusFull">â¬œ Not played</div>
    <button class="collapsible">ðŸ“œ Show Script</button>
    <div class="content" id="scriptFull">
The UK-based Al Khair Foundation said a team of charity workers has been killed in Israeli airstrikes in northern Gaza.
The charity says at least 8 workers, including volunteers and journalists documenting their work, were killed when their vehicles were targeted Saturday.
Hamas called it a blatant violation of the ceasefire agreement with Israel.
The Israeli military said it struck two terrorists operating a drone that posed a threat to Israeli troops and later targeted additional terrorists at the scene.
The charity denies the allegation, saying its team members were not terrorists.
The attack comes as US-designated terror group Hamas leaders hold ceasefire talks with mediators in Cairo.
Hamas says it will only release an American-Israeli hostage and the bodies of four others if Israel fully implements the ceasefire agreement in Gaza.
A senior Hamas official says talks on the truce's next phase must start immediately and last no more than 50 days.
    </div>
  </div>

  <script>
    setupBlock("audioFull", "statusFull", "audioPlayed_full");

    document.addEventListener("click", function (e) {
      if (e.target && e.target.classList.contains("collapsible")) {
        e.target.classList.toggle("active");
        const content = e.target.nextElementSibling;
        content.style.display = content.style.display === "block" ? "none" : "block";
      }
    });
  </script>

</body>
</html>
